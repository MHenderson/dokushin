\documentclass{beamer}
\input{packages}
\title{\talktitle}
\author{\Us}
\date{\talkdate}

\begin{document}

\begin{frame}
  \titlepage
  \conferencebanner
\end{frame}

\begin{frame}
\frametitle{Background - The OKlibrary}
 \begin{itemize}
  \item<1-> \url{http://www.ok-sat-library.org/}
  \item<2-> Open-source research platform and generative library for generalised SAT solving
  \item<3-> Developed by Oliver Kullmann at the University of Swansea since 2005.
  \item<4-> Modeling of combinatorial puzzles via SAT (Latin squares/Sudoku)
  \item<5-> C++/Lisp/Bash
 \end{itemize}
\end{frame}

\begin{frame}
\frametitle{Background - \texttt{sudoku.py}}
 \begin{itemize}
  \item<1-> \url{http://bitbucket.org/matthew/scipy2010}
  \item<2-> Open-source 
  \item<3-> Developed by authors at Berea College since 2010
  \item<4-> Modeling of Sudoku puzzles in a variety of domains
  \item<5-> Python
 \end{itemize}
\end{frame}

\begin{frame}
\frametitle{Overview}
 \begin{itemize}
  \item<1-> {Modeling Sudoku in Python
    \begin{itemize}
      \item<2-> Constraint models
      \item<3-> Graph models
      \item<4-> IP models
      \item<5-> Polynomial models
    \end{itemize}}
  \item<6-> {Using \texttt{sudoku.py} 
    \begin{itemize}
      \item<7-> Creating puzzles
      \item<8-> Solving puzzles
    \end{itemize}}
 \end{itemize}
\end{frame}

\begin{frame}
 \begin{columns}[c] 
  \column{.5\textwidth} 
   A \emph{traditional Sudoku puzzle} is a partial assignment of $1,\dots,9$ to the cells of a $9\times 9$ grid with the latin property on rows, columns and boxes.
  \column{.5\textwidth}
   \begin{figure}[h]
    \centering
    \sudokuexampleone
    \caption{Sudoku puzzle}
   \end{figure} 
 \end{columns}
\end{frame}

\begin{frame}
 \begin{columns}[c]
  \column{.5\textwidth} 
   A \emph{(generalized) Sudoku puzzle} of boxsize $n$ is a partial assignment of $1,\dots,n^2$ to the cells of an $n^2\times n^2$ grid with the latin property on rows, columns and boxes.
  \column{.5\textwidth}
   \begin{figure}[h]
    \centering
    \sudokuexampleone
    \caption{Sudoku puzzle}
   \end{figure} 
 \end{columns}
\end{frame}

\begin{frame}
 \begin{columns}[c] 
  \column{.5\textwidth} 
   A \emph{solution} of a Sudoku puzzle is a total assignment which extends the original partial assignment and satisfies the same latin properties.
  \column{.5\textwidth}
   \begin{figure}[h]
    \centering
    \sudokuexampletwo
    \caption{Sudoku puzzle}
   \end{figure} 
 \end{columns}
\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- Constraints}

A \emph{constraint satisfaction problem} is a collection of \emph{constraints}. Each constraint involves certain \emph{variables}. Variables have \emph{domains}.

\pause

A \emph{solution} of a CSP is an assignment to the variables which satisfies all the constraints.
\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- Variables}

For each cell $1\leq i \leq n^4$, we have a variable $x_i$ whose domain is $\{1,\ldots,n^2\}$.

\pause

$x_i = j$ means that cell $i$ is assigned value $j$.

\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- \texttt{python-constraint}}

\url{http://labix.org/python-constraint}

Developed by Gustavo Niemeyer.

\pause

\begin{lstlisting}
>>> from constraint import Problem
>>> from sudoku import cells, symbols
>>> cp = Problem()
>>> cp.addVariables(cells(2), symbols(2))
\end{lstlisting}

\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- The AllDifferent constraint}

The \emph{AllDifferent constraint} is the CSP version of the latin condition. It forces a set of variables to have mutually different values.

\pause

\[\mbox{AllDifferent}(x_{1}, x_{2}, x_{3}, x_{4})\]\pause
\[\mbox{AllDifferent}(x_{1}, x_{5}, x_{9}, x_{13})\]\pause
\[\mbox{AllDifferent}(x_{13}, x_{14}, x_{15}, x_{16})\]

\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- The empty board}

\begin{lstlisting}
>>> from sudoku import \
     cells_by_row, cells_by_col, cells_by_box
\end{lstlisting}

\pause

\begin{lstlisting}
>>> sudoku.cells_by_row(2)
[[1, 2, 3, 4], [5, 6, 7, 8],
 [9, 10, 11, 12], [13, 14, 15, 16]]
>>> sudoku.cells_by_col(2)
[[1, 5, 9, 13], [2, 6, 10, 14], 
 [3, 7, 11, 15], [4, 8, 12, 16]]
>>> sudoku.cells_by_box(2)
[[1, 2, 5, 6], [3, 4, 7, 8], 
 [9, 10, 13, 14], [11, 12, 15, 16]]
\end{lstlisting}

\end{frame}


\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- The empty board}

\begin{lstlisting}
>>> for row in cells_by_row(2):
...   cp.addConstraint(AllDifferentConstraint(), row)
... 
\end{lstlisting}
\pause
\begin{lstlisting}
>>> for col in cells_by_col(2):
...   cp.addConstraint(AllDifferentConstraint(), col)
... 
>>> for box in cells_by_box(2):
...   cp.addConstraint(AllDifferentConstraint(), box)
\end{lstlisting}

\end{frame}


\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- The ExactSum constraint}

The \emph{ExactSum} constraint restricts the values of variables to have a given sum.

XXX puzzle example XXX

So, for cell 4 to have value 3, we need $\mbox{ExactSum}(4, 3)$

\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- Puzzles}

\begin{lstlisting}
>>> d = {3: 2, 5: 2, 6: 1, 7: 4, \
         8: 3, 10: 4, 12: 2, 13: 1}
\end{lstlisting}

\pause

\begin{lstlisting}
>>> from constraint import ExactSumConstraint as Exact
>>> for cell in d:
...   cp.addConstraint(Exact(d[cell]), [cell])
\end{lstlisting}

\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- Solving}

\begin{lstlisting}
>>> from sudoku import Puzzle
>>> Puzzle(cp.getSolution(), 2)
+-----+-----+
| 4 3 | 2 1 | 
| 2 1 | 4 3 | 
+-----+-----+
| 3 4 | 1 2 | 
| 1 2 | 3 4 | 
+-----+-----+
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- The \texttt{solve} function}

\begin{lstlisting}
>>> p = Puzzle(d, 2)
\end{lstlisting}

\pause

\begin{lstlisting}
>>> from sudoku import solve
>>> solve(p)
+-----+-----+
| 4 3 | 2 1 | 
| 2 1 | 4 3 | 
+-----+-----+
| 3 4 | 1 2 | 
| 1 2 | 3 4 | 
+-----+-----+
\end{lstlisting}

\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- Graph models}
J. Gago-Vargas, I. Hartillo-Hermosa, J. Martin-Morales, J. M. Ucha- Enriquez, \emph{Sudokus and Groebner Bases: not only a Divertimento}, In: Lecture Notes in Computer Science, vol. 4194. pp. 155-165. 2005

Networkx : \url{http://networkx.lanl.gov/}
\end{frame}


\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- Graph models}
\begin{lstlisting}
>>> from networkx import Graph
>>> g = Graph()
>>> g.add_nodes_from(cells(n))
\end{lstlisting}

\pause

\begin{lstlisting}
>>> from sudoku import dependent_cells
>>> g.add_edges_from(dependent_cells(n))
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- Node coloring}
\begin{lstlisting}
>>> for cell in d:
...   g.node[cell]['color'] = d[cell]
\end{lstlisting}

\pause

\begin{lstlisting}
>>> from sudoku import node_coloring, n_colors
>>> cg = node_coloring(g)
6
\end{lstlisting}

\pause

\begin{lstlisting}
>>> from sudoku import graph_to_dict
>>> s = Puzzle(graph_to_dict(cg), 2)
>>> s
+-----+-----+
| 3 5 | 2 6 | 
| 2 1 | 4 3 | 
+-----+-----+
| 5 4 | 3 2 | 
| 1 2 | 5 4 | 
+-----+-----+
\end{lstlisting}

\pause
\end{frame}



\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- Further models}
 \begin{figure}[h]
  \centering
  \begin{tabular}{ l c }
  Modeling domain    & Python library \\ \hline
  Integer Programming & \texttt{pyglpk v0.3} \\
                     & \url{http://tfinley.net/software/pyglpk/} \\
  Polynomials        & \texttt{sympy} \\
                     & \url{http://code.google.com/p/sympy/}
  \end{tabular}
  \caption{Table}
 \end{figure} 
\end{frame}

\begin{frame}
  The End -- Thank You!
\end{frame}

\end{document} 

