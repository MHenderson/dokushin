\documentclass{beamer}
\input{packages}
\title{\talktitle}
\author{\Us}
\date{\talkdate}

\begin{document}

\begin{frame}
  \titlepage
  \conferencebanner
\end{frame}

\begin{frame}
\frametitle{Background - The OKlibrary}
 \begin{itemize}
  \item<1-> \url{http://www.ok-sat-library.org/}
  \item<2-> Open-source research platform and generative library for generalised SAT solving
  \item<3-> Developed by Oliver Kullmann at the University of Swansea since 2005.
  \item<4-> Modeling of combinatorial puzzles via SAT (Latin squares/Sudoku)
  \item<5-> C++/Lisp/Bash
 \end{itemize}
\end{frame}

\begin{frame}
\frametitle{Background - \texttt{sudoku.py}}
 \begin{itemize}
  \item<1-> \url{http://bitbucket.org/matthew/scipy2010}
  \item<2-> Open-source 
  \item<3-> Developed by authors at Berea College since 2010
  \item<4-> Modeling of Sudoku puzzles in a variety of domains
  \item<5-> Python
 \end{itemize}
\end{frame}

\begin{frame}
\frametitle{Overview}
 \begin{itemize}
  \item<1-> {Modeling Sudoku in Python
    \begin{itemize}
      \item<2-> Constraint models
      \item<3-> Graph models
      \item<4-> Integer programming models
      \item<5-> Polynomial models
    \end{itemize}}
  \item<6-> {Using \texttt{sudoku.py} 
    \begin{itemize}
      \item<7-> Creating puzzles
      \item<8-> Solving puzzles
    \end{itemize}}
 \end{itemize}
\end{frame}

\begin{frame}
 \begin{columns}[c] 
  \column{.5\textwidth} 
   A \emph{traditional Sudoku puzzle} is a partial assignment of $1,\dots,9$ to the cells of a $9\times 9$ grid with the latin property on rows, columns and boxes.
  \column{.5\textwidth}
   \begin{figure}[h]
    \centering
    \sudokuexampleone
   \end{figure} 
 \end{columns}
\end{frame}

\begin{frame}
 \begin{columns}[c] 
  \column{.5\textwidth} 
   A \emph{solution} of a Sudoku puzzle is a total assignment which extends the original partial assignment and satisfies the same latin properties.
  \column{.5\textwidth}
   \begin{figure}[h]
    \centering
    \sudokuexampletwo
   \end{figure} 
 \end{columns}
\end{frame}

\begin{frame}
 \begin{columns}[c]
  \column{.5\textwidth} 
   A \emph{(generalized) Sudoku puzzle} of boxsize $n$ is a partial assignment of $1,\dots,n^2$ to the cells of an $n^2\times n^2$ grid with the latin property on rows, columns and boxes.
  \column{.5\textwidth}
   \begin{figure}[h]
    \centering
    \sudokuexampleone
   \end{figure} 
 \end{columns}
\end{frame}

\begin{frame}[fragile]
\frametitle{Constraint Satisfaction Problems}
A \emph{constraint satisfaction problem} (CSP) is a collection of \emph{constraints}. 
\pause 

A \emph{constraint} restricts the values assigned to certain \emph{variables}.
\pause 

A \emph{variable} $v$ has an associated \emph{domain} $D(v)$.
\pause

A \emph{solution} of a CSP is an assignment to the variables which satisfies all the constraints.
\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- Variables}

For a Sudoku puzzle of boxsize $n$ we have variables 
\[x_i  \quad 1 \leq i \leq n^4\]

The domain $D(x_i) = \{1,\ldots,n^2\}$.

$x_i = j$ means that cell $i$ is assigned value $j$.

\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- The AllDifferent constraint}
The \emph{AllDifferent constraint} forces a set of variables to have mutually different values.\pause

\pause

For example, if $n = 2$: \pause
  \begin{itemize}
   \item Row 1: $\mbox{AllDifferent}(x_{1}, x_{2}, x_{3}, x_{4})$ \pause
   \item Column 1: $\mbox{AllDifferent}(x_{1}, x_{5}, x_{9}, x_{13})$ \pause
   \item Box 1: $\mbox{AllDifferent}(x_{1}, x_{2}, x_{5}, x_{6})$ 
  \end{itemize}
\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- The ExactSum constraint}

The \emph{ExactSum} constraint restricts the values of variables to have a given sum.

So, if $x_4 = 3$, we can use the constraint $\mbox{ExactSum}(x_4, 3)$

\end{frame}


\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- \texttt{python-constraint}}

\url{http://labix.org/python-constraint}

Developed by Gustavo Niemeyer.

\pause

\begin{lstlisting}
>>> from constraint import Problem
>>> from sudoku import cells, symbols
\end{lstlisting}
\pause
\begin{lstlisting}
>>> cp = Problem()
>>> cp.addVariables(cells(2), symbols(2))
\end{lstlisting}

\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- The empty board}

\begin{lstlisting}
>>> from sudoku import \
     cells_by_row, cells_by_col, cells_by_box
\end{lstlisting}

\pause

\begin{lstlisting}
>>> sudoku.cells_by_row(2)
[[1, 2, 3, 4], [5, 6, 7, 8],
 [9, 10, 11, 12], [13, 14, 15, 16]]
\end{lstlisting}
\pause
\begin{lstlisting}
>>> sudoku.cells_by_col(2)
[[1, 5, 9, 13], [2, 6, 10, 14], 
 [3, 7, 11, 15], [4, 8, 12, 16]]
\end{lstlisting}
\pause
\begin{lstlisting}
>>> sudoku.cells_by_box(2)
[[1, 2, 5, 6], [3, 4, 7, 8], 
 [9, 10, 13, 14], [11, 12, 15, 16]]
\end{lstlisting}

\end{frame}


\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- The empty board}

\begin{lstlisting}
>>> for row in cells_by_row(2):
...   cp.addConstraint(AllDifferentConstraint(), row)
... 
\end{lstlisting}
\pause
\begin{lstlisting}
>>> for col in cells_by_col(2):
...   cp.addConstraint(AllDifferentConstraint(), col)
... 
\end{lstlisting}
\pause
\begin{lstlisting}
>>> for box in cells_by_box(2):
...   cp.addConstraint(AllDifferentConstraint(), box)
\end{lstlisting}

\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- Puzzles}

\begin{lstlisting}
>>> d = {3: 2, 5: 2, 6: 1, 7: 4, \
         8: 3, 10: 4, 12: 2, 13: 1}
\end{lstlisting}

\pause

\begin{lstlisting}
>>> from constraint import ExactSumConstraint as Exact
>>> for cell in d:
...   cp.addConstraint(Exact(d[cell]), cell)
\end{lstlisting}

\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- Solving}
\begin{lstlisting}
>>> cp.getSolution() 
{1: 4,
 2: 3,
 3: 2,
 4: 1,
 5: 2,
 6: 1,
 7: 4,
 8: 3,
 9: 3,
 10: 4,
 11: 1,
 12: 2,
 13: 1,
 14: 2,
 15: 3,
 16: 4}
\end{lstlisting}
\end{frame}


\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- \texttt{Puzzle} objects}
\begin{lstlisting}
>>> from sudoku import Puzzle
\end{lstlisting}
\pause
\begin{lstlisting}
>>> Puzzle(cp.getSolution(), 2)
+-----+-----+
| 4 3 | 2 1 | 
| 2 1 | 4 3 | 
+-----+-----+
| 3 4 | 1 2 | 
| 1 2 | 3 4 | 
+-----+-----+
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- The \texttt{solve} function}

\begin{lstlisting}
>>> p = Puzzle(d, 2)
\end{lstlisting}

\pause

\begin{lstlisting}
>>> from sudoku import solve
>>> solve(p)
+-----+-----+
| 4 3 | 2 1 | 
| 2 1 | 4 3 | 
+-----+-----+
| 3 4 | 1 2 | 
| 1 2 | 3 4 | 
+-----+-----+
\end{lstlisting}

\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- Graph models}
\begin{itemize}
 \item J. Gago-Vargas, I. Hartillo-Hermosa, J. Martin-Morales, J. M. Ucha- Enriquez, \emph{Sudokus and Groebner Bases: not only a Divertimento}, In: Lecture Notes in Computer Science, vol. 4194. pp. 155-165. 2005
 \pause
 \item The graph model has a \emph{node} for every cell. Two nodes are adjacent in the graph model if they represent \emph{dependent cells}.
\end{itemize}
\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- Graph models}
  \begin{figure}[h]
   \centering
  \begin{dot2tex}[circo,mathmode,options={--graphstyle "scale=0.25"}]
   \input{../dot/empty_sudoku_graph_2.dot}
  \end{dot2tex}
  \caption{The Shidoku graph}
 \end{figure}
\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- Graph models}
Networkx : \url{http://networkx.lanl.gov/}

\begin{lstlisting}
>>> from networkx import Graph
>>> g = Graph()
>>> g.add_nodes_from(cells(2))
\end{lstlisting}

\pause

\begin{lstlisting}
>>> from sudoku import dependent_cells
>>> g.add_edges_from(dependent_cells(2))
\end{lstlisting}
\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- Node coloring}
\begin{lstlisting}
>>> for cell in d:
...   g.node[cell]['color'] = d[cell]
\end{lstlisting}

\pause

\begin{lstlisting}
>>> from sudoku import node_coloring, n_colors
>>> cg = node_coloring(g)
>>> n_colors(cg)
6
\end{lstlisting}

\pause

\begin{lstlisting}
>>> from sudoku import graph_to_dict
>>> s = Puzzle(graph_to_dict(cg), 2)
>>> s
+-----+-----+
| 3 5 | 2 6 | 
| 2 1 | 4 3 | 
+-----+-----+
| 5 4 | 3 2 | 
| 1 2 | 5 4 | 
+-----+-----+
\end{lstlisting}

\end{frame}

\begin{frame}[fragile]
\frametitle{Modeling Sudoku -- Further models}
 \begin{figure}[h]
  \centering
  \begin{tabular}{ l c }
  Modeling domain    & Python library \\ \hline
  Integer Programming & \texttt{pyglpk v0.3} \\
                     & \url{http://tfinley.net/software/pyglpk/} \\
  Polynomials        & \texttt{sympy} \\
                     & \url{http://code.google.com/p/sympy/}
  \end{tabular}
 \end{figure} 
\end{frame}

\end{document} 

